# 更新日志

## 2026.1.5 20:47 更新

### 目标
解决 Task2 中 `filter` 路径误码率过高、BER-SNR 曲线趋势不正确的问题（高 SNR 仍接近 0.5）。

### 核心问题定位
因果滤波（`filter`）会引入群时延与相位畸变，导致检测比特与原始比特在判决时刻不对齐，BER 统计出现“接近随机猜测”的假象。

### 主要修改
1. **加入比特对齐（延时校正）**
   - 新增 `align_bits` 函数，用包络/判决量与原始比特的互相关估计滞后，并对齐再做 BER 统计。
   - 位置：`task2.m:160-183`。

2. **`filter` 路径使用对齐后的参考比特进行 BER 统计**
   - `filter` 解调后先做对齐，再绘图和计算 BER。
   - 位置：`task2.m:27-33`, `task2.m:75-78`, `task2.m:92-95`。

3. **BER-SNR 计算修正（区分对齐后的有效比特长度）**
   - 统计 `filter` 路径时采用对齐后的有效比特长度，避免总比特数计算偏差。
   - 位置：`task2.m:107-137`。

### 为什么这样改
- `filter` 是因果滤波，会引入稳定的延时；不对齐直接比较会导致系统性误判。
- 使用互相关估计延时能在不改变核心算法的前提下，恢复正确的判决对齐关系。
- 修正 BER 统计后，`filter` 路径的 BER-SNR 曲线呈现“随 SNR 增大 BER 下降”的正常趋势。

### 影响与效果
- `filtfilt` 路径保持原有零相位效果，BER 近 0。
- `filter` 路径不再出现高 SNR 下 BER≈0.5 的异常趋势。
- 曲线形态与课程要求一致：SNR 越高，BER 越低。

### 涉及文件
- `task2.m`：延时对齐 + BER 统计修正 + 曲线计算修正。

---

## 2026.1.5 21:30 更新

### 目标
调整 Task3 的 BER-SNR 曲线，使其不再全 0，并且与 Task2 的表现形式一致（零相位 vs 因果）。

### 主要修改
1. **SNR 扫描范围下移**
   - 将 `snr_list` 从 `0:2:16` 改为 `-6:2:12`，确保在低 SNR 下出现可见误码。
   - 位置：`task3.m:112`。

2. **曲线形式对齐 Task2**
   - 将 Task3 的 A/B 分别绘制改为“平均 BER 一条曲线”，只保留“零相位(理想)”与“因果(现实)”两条曲线。
   - 位置：`task3.m:117-174`。

3. **统计稳定性提升**
   - `frames` 从 20 调至 30，降低随机性导致的偶然全 0 现象。
   - 位置：`task3.m:113`。

### 为什么这样改
- 原 SNR 范围过高导致 BER 长时间为 0，无法体现“噪声变大误码变大”的趋势。
- 与 Task2 统一曲线风格，方便报告对照说明。

### 影响与效果
- Task3 的 BER-SNR 曲线在低 SNR 段出现明显误码，整体随 SNR 提升而下降。
- 图形样式与 Task2 保持一致，符合老师要求。

### 涉及文件
- `task3.m`：SNR 扫描范围、曲线统计与绘制调整。

